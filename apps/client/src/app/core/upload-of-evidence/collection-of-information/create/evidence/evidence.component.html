<section class="h-full">
  <div class="flex flex-row gap-4">
    <h3 class="text-color-secondary">Evidencias</h3>
    <button class="p-panel-header-icon p-link mr-2">
      <span
        (click)="addEvidence()"
        class="pi pi-plus"
        style="
          color: #3b82f6;
          border: solid 1.5px #3b82f6;
          border-radius: 100%;
          padding: 6px;
        "
      ></span>
    </button>
  </div>
  @for (evidence of evidences; track evidence) {
    <p-panel
      expandIcon="pi pi-minus"
      collapseIcon="pi pi-plus"
      [toggleable]="true"
      collapsed="true"
      iconPos="start"
      styleClass="m-0"
    >
      <ng-template pTemplate="header" class="p-0">
        <section
          class="flex flex-row justify-content-start align-items-center gap-4 w-full"
        >
          <h3 class="text-lg">Evidencia {{ evidence }}</h3>
          <button class="p-panel-header-icon p-link mr-2">
            <span
              class="pi pi-trash"
              style="
                color: #ef4444;
                border: solid 1.5px #ef4444;
                border-radius: 100%;
                padding: 6px;
              "
            ></span>
          </button>
        </section>
      </ng-template>
      <form [formGroup]="formGroup">
        <p-dropdown
          [options]="typesOfEvidence"
          optionLabel="name"
          [showClear]="true"
          placeholder="Selecciona un tipo de evidencia"
          formControlName="selectedType"
          required="true"
          [className]=""
        />
        @switch (formGroup.controls.selectedType.value?.code ?? '') {
          @case ('image') {
            <evidence-image />
          }
          @case ('link') {
            <evidence-link />
          }
          @case ('document') {
            <evidence-document />
          }
          @default {
            <p>No hay un tipo de evidencia seleccionado</p>
          }
        }
      </form>
    </p-panel>
  }
</section>
