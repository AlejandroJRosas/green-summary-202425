<div class="p-4">
  <header class="flex w-full justify-content-between align-items-center">
    <h2>Registro de Evidencias</h2>
    <p-dropdown
      [options]="recopilations"
      [(ngModel)]="recopilation"
      placeholder="Seleccione una recopilación"
      optionLabel="name"
      (onChange)="updateIndicators()"
    />
  </header>
  <main class="">
    <header class="flex w-full justify-content-between align-items-center">
      <h3 class="text-2xl">Categorías</h3>
      <p-dropdown
        [options]="indicators"
        [(ngModel)]="indicator"
        placeholder="Seleccione un indicador"
        optionLabel="alias"
        (onChange)="updateCategoriesAndCriteria()"
        [emptyMessage]="
          recopilation
            ? 'No hay indicadores disponibles'
            : 'Seleccione una recopilación antes de seleccionar un indicador'
        "
      />
    </header>
    <div class="flex flex-column">
      @for (category of categoriesAndCriteria; track category.id) {
        <p-panel toggleable="true" toggler="icon" iconPos="start" collapsed>
          <ng-template pTemplate="header">
            <app-records-category-header
              class="w-full"
              [recopilationId]="recopilation?.id"
              [category]="category"
              [criteria]="category.criteria"
            />
          </ng-template>
          <app-records-category-body
            [recopilationId]="recopilation?.id"
            [category]="category"
            [criteria]="category.criteria"
          />
        </p-panel>
      }
    </div>
  </main>
</div>
